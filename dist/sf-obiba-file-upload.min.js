angular.module("sfObibaFileUploadTemplates",[]).run(["$templateCache",function(e){e.put("src/templates/attachments-print-friendly.html",'<div>\n  <label class="control-label" >\n    <span ng-if="files && files.length > 0"><i class="fa fa-check-square-o"></i> </span>\n    <span ng-if="!files || files.length < 1"><i class="fa fa-square-o"></i> </span>\n    {{title}}\n  </label>\n  <br/>\n  <ul class="hoffset3 list-unstyled" ng-if="files.length > 0">\n    <li ng-repeat="file in files">\n      <span><strong>{{file.fileName}}</strong><small>, {{file.timestamps.created | amDateFormat:\'dddd, MMMM Do YYYY\'}}</small>\n      </span>\n    </li>\n  </ul>\n</div>'),e.put("src/templates/sf-obiba-file-upload.html",'<div class="form-group"\n     ng-controller="sfObibaFileUploadController"\n     ng-class="{\'has-error\': form.disableErrorState !== true && hasError(), \'has-success\': form.disableSuccessState !== true && hasSuccess(), \'has-feedback\': form.feedback !== false }"\n     schema-validate="form"\n     sf-field-model>\n\n  <div class="visible-print" attachments-print-friendly sf-field-model="replaceAll" files="$$value$$.obibaFiles" title="form.title"></div>\n\n  <div class="hidden-print">\n    <label ng-if="!form.notitle" class="control-label" >{{form.title}}</label>\n\n    <div>\n      <attachment-input ng-if="!form.readonly"\n                        sf-field-model="replaceAll"\n                        files="$$value$$.obibaFiles"\n                        multiple="form.schema.multiple"\n                        on-error="form.onError"\n      ></attachment-input>\n\n      <attachment-list ng-if="form.readonly"\n                       empty-message="form.emptyMessage"\n                       href-builder="getDownloadUrl"\n                       files="$$value$$.obibaFiles"\n                       sf-field-model="replaceAll"></attachment-list>\n\n      <span class="help-block" sf-message="form.helpvalue"></span>\n    </div>\n  </div>\n</div>')}]),angular.module("sfObibaFileUpload",["schemaForm","sfObibaFileUploadTemplates","ngObibaMica"]).provider("sfObibaFileUploadOptions",function(){function e(e,a,l){n[e].hasOwnProperty(a)&&(n[e][a]=l)}function a(e,a){var l=this;l.options=e,l.tr=function(e,l){return a.translate(e,l)}}var l=this,n={general:{emptyMessage:null},validationMessages:{missingFiles:null,minItems:null}};l.getOptions=function(){return angular.copy(n)},l.setGeneralMessage=function(a,l){e("general",a,l)},l.setValidationMessage=function(a,l){e("validationMessages",a,l)},l.$get=["LocaleStringUtils",function(e){return new a(l.getOptions(),e)}]}).config(["schemaFormProvider","schemaFormDecoratorsProvider","sfPathProvider","sfBuilderProvider",function(e,a,l,n){var i=function(a,n,i){if("object"===n.type&&"obibaFiles"===n.format){var t=e.stdFormObj(a,n,i);return t.onError=i.global.onError,t.key=i.path,t.type="obibaFileUpload",t.$validators={missingFiles:function(e){return!e||!i.required||e.obibaFiles&&e.obibaFiles.length>0},minItems:function(e){return!e||!n.minItems||e.obibaFiles&&e.obibaFiles.length>=n.minItems}},i.lookup[l.stringify(i.path)]=t,t}};e.defaults.object.unshift(i),a.defineAddOn("bootstrapDecorator","obibaFileUpload","src/templates/sf-obiba-file-upload.html",n.stdBuilders)}]).controller("sfObibaFileUploadController",["$scope","ngObibaMicaUrl","sfObibaFileUploadOptions",function(e,a,l){e.getDownloadUrl=function(e){return a.getUrl("SchemaFormAttachmentDownloadResource").replace(":path",e.path).replace(":attachmentName",e.fileName).replace(":attachmentId",e.id).replace("//","/")},e.$watch("form",function(){var a=e.form.schema;a.minItems&&a.minItems>1&&(a.multiple=!0);var n=l.options;e.form.disableErrorState=e.form.hasOwnProperty("readonly")&&e.form.readonly,e.$on("schemaFormValidate",function(){e.form.disableErrorState=void 0}),e.form.general||(e.form.general={}),e.form.emptyMessage||(e.form.emptyMessage=l.tr(n.general.emptyMessage)),e.form.validationMessage||(e.form.validationMessage={}),e.form.validationMessage.missingFiles||(e.form.validationMessage.missingFiles=l.tr(n.validationMessages.missingFiles,null)),e.form.validationMessage.minItems||(e.form.validationMessage.minItems=l.tr(n.validationMessages.minItems,[a.minItems]))}),e.$watch("ngModel.$modelValue",function(){e.ngModel.$validate?(e.ngModel.$options=e.ngModel.$options||{},e.ngModel.$options={allowInvalid:!0},e.ngModel.$validate(),e.ngModel.$invalid&&(e.ngModel.$dirty=!0,e.ngModel.$pristine=!1)):e.ngModel.$setViewValue(ngModel.$viewValue)},!0)}]).directive("attachmentsPrintFriendly",[function(){return{restrict:"EA",replace:!0,scope:{title:"=",files:"="},templateUrl:"src/templates/attachments-print-friendly.html"}}]);